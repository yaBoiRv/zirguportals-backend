generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["auth", "public"]
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model User {
  instance_id                                       String?                     @db.Uuid
  id                                                String                      @id @default(uuid()) @db.Uuid
  aud                                               String?                     @db.VarChar(255)
  role                                              String?                     @db.VarChar(255)
  email                                             String?                     @db.VarChar(255)
  encrypted_password                                String?                     @db.VarChar(255)
  email_confirmed_at                                DateTime?                   @db.Timestamptz(6)
  invited_at                                        DateTime?                   @db.Timestamptz(6)
  confirmation_token                                String?                     @db.VarChar(255)
  confirmation_sent_at                              DateTime?                   @db.Timestamptz(6)
  recovery_token                                    String?                     @db.VarChar(255)
  recovery_sent_at                                  DateTime?                   @db.Timestamptz(6)
  email_change_token_new                            String?                     @db.VarChar(255)
  email_change                                      String?                     @db.VarChar(255)
  email_change_sent_at                              DateTime?                   @db.Timestamptz(6)
  last_sign_in_at                                   DateTime?                   @db.Timestamptz(6)
  raw_app_meta_data                                 Json?
  raw_user_meta_data                                Json?
  is_super_admin                                    Boolean?
  createdAt                                         DateTime?                   @map("created_at") @db.Timestamptz(6)
  updatedAt                                         DateTime?                   @updatedAt @map("updated_at") @db.Timestamptz(6)
  phone                                             String?                     @unique
  phone_confirmed_at                                DateTime?                   @db.Timestamptz(6)
  phone_change                                      String?                     @default("")
  phone_change_token                                String?                     @default("") @db.VarChar(255)
  phone_change_sent_at                              DateTime?                   @db.Timestamptz(6)
  confirmed_at                                      DateTime?                   @default(dbgenerated("LEAST(email_confirmed_at, phone_confirmed_at)")) @db.Timestamptz(6)
  email_change_token_current                        String?                     @default("") @db.VarChar(255)
  email_change_confirm_status                       Int?                        @default(0) @db.SmallInt
  banned_until                                      DateTime?                   @db.Timestamptz(6)
  reauthentication_token                            String?                     @default("") @db.VarChar(255)
  reauthentication_sent_at                          DateTime?                   @db.Timestamptz(6)
  is_sso_user                                       Boolean                     @default(false)
  deleted_at                                        DateTime?                   @db.Timestamptz(6)
  passwordHash                                      String?                     @map("password_hash")
  emailVerified                                     Boolean                     @default(false) @map("email_verified")
  email_verification_tokens                         email_verification_tokens[]
  identities                                        identities[]
  mfa_factors                                       mfa_factors[]
  oauth_authorizations                              oauth_authorizations[]
  oauth_consents                                    oauth_consents[]
  one_time_tokens                                   one_time_tokens[]
  password_reset_tokens                             password_reset_tokens[]
  sessions                                          sessions[]
  blog_posts                                        blog_posts[]
  equipment_listings                                equipment_listings[]
  forum_group_members                               forum_group_members[]
  forum_groups                                      forum_groups[]
  forumLikes                                        ForumLike[]
  forumReplies                                      ForumReply[]
  forumTopics                                       ForumTopic[]
  horse_listings                                    horse_listings[]
  profile                                           Profile?
  service_favorites                                 service_favorites[]
  services                                          services[]
  trainer_chats_trainer_chats_client_user_idTousers trainer_chats[]             @relation("trainer_chats_client_user_idTousers")
  trainer_chats_trainer_chats_sender_idTousers      trainer_chats[]             @relation("trainer_chats_sender_idTousers")
  trainers                                          trainers[]
  user_roles                                        user_roles[]

  @@index([instance_id])
  @@map("users")
  @@schema("auth")
}

model Profile {
  id                      String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId                  String               @unique @map("user_id") @db.Uuid
  name                    String
  avatarUrl               String?              @map("avatar_url")
  phone                   String?
  createdAt               DateTime             @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt               DateTime             @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  username                String?              @unique
  hasTrainerProfile       Boolean?             @default(false) @map("has_trainer_profile")
  notificationPreferences Json?                @default("{\"favorites\": true, \"new_listings\": true, \"chat_messages\": true, \"first_login_done\": false}") @map("notification_preferences")
  defaultLanguage         String?              @default("en") @map("default_language")
  announcements           Announcements[]
  blog_posts              blog_posts[]
  chat_messages           chat_messages[]
  equipment_listings      equipment_listings[]
  horse_listings          horse_listings[]
  user                    User                 @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  services                services[]
  trainers                trainers[]
  conversations           ConversationParticipant[]
  messages                Message[]

  @@map("profiles")
  @@schema("public")
}

model AnnouncementCategory {
  id           Int                               @id @default(autoincrement())
  key          String                            @unique @db.VarChar(50)
  icon         String?                           @db.VarChar(50)
  translations AnnouncementCategoryTranslation[]

  @@map("announcement_categories")
  @@schema("public")
}

model AnnouncementCategoryTranslation {
  id         Int                  @id @default(autoincrement())
  categoryId Int                  @map("category_id")
  langCode   String               @map("lang_code") @db.VarChar(5)
  name       String               @db.VarChar(100)
  category   AnnouncementCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([categoryId, langCode])
  @@map("announcement_category_translations")
  @@schema("public")
}

model Country {
  id             Int                  @id @default(autoincrement())
  key            String               @unique @db.VarChar(10)
  lat            Float?
  lon            Float?
  translations   CountryTranslation[]
  municipalities municipalities[]

  @@map("countries")
  @@schema("public")
}

model CountryTranslation {
  id        Int     @id @default(autoincrement())
  countryId Int     @map("country_id")
  langCode  String  @map("lang_code") @db.VarChar(5)
  name      String  @db.VarChar(100)
  country   Country @relation(fields: [countryId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([countryId, langCode])
  @@map("country_translations")
  @@schema("public")
}

model EquipmentBrand {
  id                 Int                  @id @default(autoincrement())
  key                String               @unique @db.VarChar(255)
  name               String
  equipment_listings equipment_listings[]

  @@map("equipment_brands")
  @@schema("public")
}

model EquipmentColor {
  id                       Int                         @id @default(autoincrement())
  key                      String                      @unique @db.VarChar(50)
  hex                      String?                     @db.Char(7)
  translations             EquipmentColorTranslation[]
  equipment_listing_colors equipment_listing_colors[]

  @@map("equipment_colors")
  @@schema("public")
}

model EquipmentColorTranslation {
  id       Int            @id @default(autoincrement())
  colorId  Int            @map("color_id")
  langCode String         @map("lang_code") @db.VarChar(5)
  name     String         @db.VarChar(100)
  color    EquipmentColor @relation(fields: [colorId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([colorId, langCode])
  @@map("equipment_color_translations")
  @@schema("public")
}

model EquipmentCondition {
  id           Int                             @id @default(autoincrement())
  key          String                          @unique @db.VarChar
  translations EquipmentConditionTranslation[]

  @@map("equipment_conditions")
  @@schema("public")
}

model EquipmentConditionTranslation {
  id          Int                @id @default(autoincrement())
  conditionId Int                @map("condition_id")
  langCode    String             @map("lang_code") @db.VarChar
  name        String             @db.VarChar
  condition   EquipmentCondition @relation(fields: [conditionId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([conditionId, langCode])
  @@unique([conditionId, langCode], map: "equipment_condition_translations_uidx")
  @@map("equipment_condition_translations")
  @@schema("public")
}

model EquipmentType {
  id                       Int                        @id @default(autoincrement())
  key                      String                     @unique @db.VarChar
  equipment_listings       equipment_listings[]
  equipment_type_materials equipment_type_materials[]
  translations             EquipmentTypeTranslation[]

  @@map("equipment_types")
  @@schema("public")
}

model EquipmentTypeTranslation {
  id       Int           @id @default(autoincrement())
  typeId   Int           @map("type_id")
  langCode String        @map("lang_code") @db.VarChar
  name     String        @db.VarChar
  type     EquipmentType @relation(fields: [typeId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([typeId, langCode])
  @@unique([typeId, langCode], map: "equipment_type_translations_uidx")
  @@map("equipment_type_translations")
  @@schema("public")
}

model EquipmentMaterial {
  id                       Int                            @id @default(autoincrement())
  key                      String                         @unique @db.VarChar(255)
  equipment_listings       equipment_listings[]
  translations             EquipmentMaterialTranslation[]
  equipment_type_materials equipment_type_materials[]

  @@map("equipment_materials")
  @@schema("public")
}

model EquipmentMaterialTranslation {
  id         Int               @id @default(autoincrement())
  materialId Int               @map("material_id")
  langCode   String            @map("lang_code") @db.VarChar(10)
  name       String            @db.VarChar(255)
  material   EquipmentMaterial @relation(fields: [materialId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([materialId, langCode])
  @@unique([materialId, langCode], map: "equipment_material_translations_uidx")
  @@map("equipment_material_translations")
  @@schema("public")
}

model ForumCategory {
  id           Int                        @id @default(autoincrement())
  key          String                     @unique @db.VarChar(100)
  icon         String?                    @db.VarChar(50)
  translations ForumCategoryTranslation[]

  @@map("forum_categories")
  @@schema("public")
}

model ForumCategoryTranslation {
  id          Int           @id @default(autoincrement())
  categoryId  Int           @map("category_id")
  langCode    String        @map("lang_code") @db.VarChar(5)
  name        String        @db.VarChar(255)
  description String?
  category    ForumCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([categoryId, langCode])
  @@index([categoryId], map: "idx_forum_category_translations_category_id")
  @@index([langCode], map: "idx_forum_category_translations_lang_code")
  @@map("forum_category_translations")
  @@schema("public")
}

model HorseBreed {
  id             Int                     @id @default(autoincrement())
  key            String                  @unique @db.VarChar(100)
  translations   HorseBreedTranslation[]
  horse_listings horse_listings[]

  @@map("horse_breeds")
  @@schema("public")
}

model HorseBreedTranslation {
  id       Int        @id @default(autoincrement())
  breedId  Int        @map("breed_id")
  langCode String     @map("lang_code") @db.VarChar(10)
  name     String     @db.VarChar(255)
  breed    HorseBreed @relation(fields: [breedId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([breedId, langCode])
  @@map("horse_breed_translations")
  @@schema("public")
}

model PonyBreed {
  id             Int                    @id @default(autoincrement())
  key            String                 @unique @db.VarChar(100)
  horse_listings horse_listings[]
  translations   PonyBreedTranslation[]

  @@map("pony_breeds")
  @@schema("public")
}

model PonyBreedTranslation {
  id       Int       @id @default(autoincrement())
  breedId  Int       @map("breed_id")
  langCode String    @map("lang_code") @db.VarChar(10)
  name     String    @db.VarChar(255)
  breed    PonyBreed @relation(fields: [breedId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([breedId, langCode])
  @@map("pony_breed_translations")
  @@schema("public")
}

model HorseColor {
  id                   Int                     @id @default(autoincrement())
  key                  String                  @unique @db.VarChar(50)
  hex                  String?                 @db.Char(7)
  translations         HorseColorTranslation[]
  horse_listing_colors horse_listing_colors[]

  @@map("horse_colors")
  @@schema("public")
}

model HorseColorTranslation {
  id       Int        @id @default(autoincrement())
  colorId  Int        @map("color_id")
  langCode String     @map("lang_code") @db.VarChar(5)
  name     String     @db.VarChar(100)
  color    HorseColor @relation(fields: [colorId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@map("horse_color_translations")
  @@schema("public")
}

model HorseDiscipline {
  id                        Int                          @id @default(autoincrement())
  key                       String                       @unique @db.VarChar(100)
  translations              HorseDisciplineTranslation[]
  horse_listing_disciplines horse_listing_disciplines[]

  @@map("horse_disciplines")
  @@schema("public")
}

model HorseDisciplineTranslation {
  id           Int             @id @default(autoincrement())
  disciplineId Int             @map("discipline_id")
  langCode     String          @map("lang_code") @db.VarChar(10)
  name         String          @db.VarChar(255)
  discipline   HorseDiscipline @relation(fields: [disciplineId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([disciplineId, langCode])
  @@map("horse_discipline_translations")
  @@schema("public")
}

model HorseSex {
  id             Int                   @id @default(autoincrement())
  key            String                @unique @db.VarChar(50)
  horse_listings horse_listings[]
  translations   HorseSexTranslation[]

  @@map("horse_sex")
  @@schema("public")
}

model HorseSexTranslation {
  id       Int      @id @default(autoincrement())
  sexId    Int      @map("sex_id")
  langCode String   @map("lang_code") @db.VarChar(10)
  name     String   @db.VarChar(255)
  sex      HorseSex @relation(fields: [sexId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([sexId, langCode])
  @@map("horse_sex_translations")
  @@schema("public")
}

model HorseTemperament {
  id                         Int                           @id @default(autoincrement())
  key                        String                        @unique @db.VarChar(100)
  horse_listing_temperaments horse_listing_temperaments[]
  translations               HorseTemperamentTranslation[]

  @@map("horse_temperament")
  @@schema("public")
}

model HorseTemperamentTranslation {
  id            Int              @id @default(autoincrement())
  temperamentId Int              @map("temperament_id")
  langCode      String           @map("lang_code") @db.VarChar(10)
  name          String           @db.VarChar(255)
  temperament   HorseTemperament @relation(fields: [temperamentId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([temperamentId, langCode])
  @@map("horse_temperament_translations")
  @@schema("public")
}

model ServiceSpecialty {
  specialty_key                  String                        @unique
  created_at                     DateTime?                     @default(now()) @db.Timestamptz(6)
  id                             BigInt                        @id @default(autoincrement())
  service_specialty_translations ServiceSpecialtyTranslation[]

  @@map("service_specialties")
  @@schema("public")
}

model ServiceSpecialtyTranslation {
  specialty_key       String
  langCode            String           @map("lang_code")
  name                String
  created_at          DateTime?        @default(now()) @db.Timestamptz(6)
  id                  Int              @id @default(autoincrement())
  service_specialties ServiceSpecialty @relation(fields: [specialty_key], references: [specialty_key], onDelete: Cascade, onUpdate: NoAction)

  @@unique([specialty_key, langCode], map: "service_specialty_translations_specialty_key_language_code_key")
  @@map("service_specialty_translations")
  @@schema("public")
}

model TrainerSpecialty {
  id           Int                           @id
  key          String                        @unique @db.VarChar(100)
  translations TrainerSpecialtyTranslation[]

  @@map("trainer_specialties")
  @@schema("public")
}

model TrainerSpecialtyTranslation {
  id          Int              @id @default(autoincrement())
  specialtyId Int              @map("specialty_id")
  langCode    String           @map("lang_code") @db.VarChar(5)
  name        String           @db.VarChar(255)
  specialty   TrainerSpecialty @relation(fields: [specialtyId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([specialtyId, langCode])
  @@map("trainer_specialty_translations")
  @@schema("public")
}

model TrainerLanguage {
  id                            Int                             @id
  key                           String                          @unique @db.VarChar(100)
  trainer_language_translations trainer_language_translations[]

  @@map("trainer_languages")
  @@schema("public")
}

model TrainerCertification {
  id           Int                               @id
  key          String                            @unique @db.VarChar(100)
  translations TrainerCertificationTranslation[]

  @@map("trainer_certifications")
  @@schema("public")
}

model TrainerCertificationTranslation {
  id              Int                  @id @default(autoincrement())
  certificationId Int                  @map("certification_id")
  langCode        String               @map("lang_code") @db.VarChar(5)
  name            String               @db.VarChar(255)
  certification   TrainerCertification @relation(fields: [certificationId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([certificationId, langCode], map: "trainer_certification_translatio_certification_id_lang_code_key")
  @@map("trainer_certification_translations")
  @@schema("public")
}

model Announcements {
  id           String    @id @default(uuid()) @db.Uuid
  title        String
  content      String
  category     String    @default("general")
  is_pinned    Boolean   @default(false) @map("is_pinned")
  createdAt    DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime  @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  userId       String    @map("user_id") @db.Uuid
  images       String[]  @default([])
  files        String[]  @default([])
  pinned_until DateTime? @map("pinned_until") @db.Timestamptz(6)
  user         Profile   @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction, map: "fk_announcements_user")

  @@index([category], map: "idx_announcements_category")
  @@index([createdAt(sort: Desc)], map: "idx_announcements_created_at")
  @@index([is_pinned], map: "idx_announcements_is_pinned")
  @@map("announcements")
  @@schema("public")
}

model ForumTopic {
  id            String        @id @default(uuid()) @db.Uuid
  title         String
  content       String
  category      String?       @default("general")
  userId        String        @map("user_id") @db.Uuid
  createdAt     DateTime      @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt     DateTime      @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  likesCount    Int?          @default(0) @map("likes_count")
  repliesCount  Int?          @default(0) @map("replies_count")
  is_pinned     Boolean?      @default(false)
  last_reply_at DateTime?     @default(now()) @db.Timestamptz(6)
  images        String[]      @default([])
  group_id      String?       @db.Uuid
  files         String[]      @default([])
  viewsCount    Int           @default(0) @map("views_count")
  likes         ForumLike[]
  replies       ForumReply[]
  forum_groups  forum_groups? @relation(fields: [group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user          User          @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@map("forum_topics")
  @@schema("public")
}

model ForumReply {
  id         String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  topicId    String       @map("topic_id") @db.Uuid
  content    String
  userId     String       @map("user_id") @db.Uuid
  createdAt  DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime     @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  likesCount Int?         @default(0) @map("likes_count")
  images     String[]     @default([])
  parentId   String?      @map("parent_id") @db.Uuid
  files      String[]     @default([])
  likes      ForumLike[]
  parent     ForumReply?  @relation("ReplyToReply", fields: [parentId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  children   ForumReply[] @relation("ReplyToReply")
  topic      ForumTopic   @relation(fields: [topicId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user       User         @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([parentId], map: "idx_forum_replies_parent_id")
  @@map("forum_replies")
  @@schema("public")
}

model ForumLike {
  id        String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId    String      @map("user_id") @db.Uuid
  topicId   String?     @map("topic_id") @db.Uuid
  replyId   String?     @map("reply_id") @db.Uuid
  createdAt DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  reply     ForumReply? @relation(fields: [replyId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  topic     ForumTopic? @relation(fields: [topicId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user      User        @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([userId, topicId])
  @@unique([userId, replyId])
  @@map("forum_likes")
  @@schema("public")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model audit_log_entries {
  instance_id String?   @db.Uuid
  id          String    @id @db.Uuid
  payload     Json?     @db.Json
  created_at  DateTime? @db.Timestamptz(6)
  ip_address  String    @default("") @db.VarChar(64)

  @@index([instance_id], map: "audit_logs_instance_id_idx")
  @@schema("auth")
}

model email_verification_tokens {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String   @db.Uuid
  token_hash String   @unique
  expires_at DateTime @db.Timestamptz(6)
  created_at DateTime @default(now()) @db.Timestamptz(6)
  users      User     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([user_id], map: "idx_email_verif_user")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model flow_state {
  id                     String                @id @db.Uuid
  user_id                String?               @db.Uuid
  auth_code              String
  code_challenge_method  code_challenge_method
  code_challenge         String
  provider_type          String
  provider_access_token  String?
  provider_refresh_token String?
  created_at             DateTime?             @db.Timestamptz(6)
  updated_at             DateTime?             @db.Timestamptz(6)
  authentication_method  String
  auth_code_issued_at    DateTime?             @db.Timestamptz(6)
  saml_relay_states      saml_relay_states[]

  @@index([created_at(sort: Desc)])
  @@index([auth_code], map: "idx_auth_code")
  @@index([user_id, authentication_method], map: "idx_user_id_auth_method")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model identities {
  provider_id     String
  user_id         String    @db.Uuid
  identity_data   Json
  provider        String
  last_sign_in_at DateTime? @db.Timestamptz(6)
  created_at      DateTime? @db.Timestamptz(6)
  updated_at      DateTime? @db.Timestamptz(6)
  email           String?   @default(dbgenerated("lower((identity_data ->> 'email'::text))"))
  id              String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  users           User      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([provider_id, provider], map: "identities_provider_id_provider_unique")
  @@index([email])
  @@index([user_id])
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model instances {
  id              String    @id @db.Uuid
  uuid            String?   @db.Uuid
  raw_base_config String?
  created_at      DateTime? @db.Timestamptz(6)
  updated_at      DateTime? @db.Timestamptz(6)

  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model mfa_amr_claims {
  session_id            String   @db.Uuid
  created_at            DateTime @db.Timestamptz(6)
  updated_at            DateTime @db.Timestamptz(6)
  authentication_method String
  id                    String   @id(map: "amr_id_pk") @db.Uuid
  sessions              sessions @relation(fields: [session_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([session_id, authentication_method], map: "mfa_amr_claims_session_id_authentication_method_pkey")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model mfa_challenges {
  id                     String      @id @db.Uuid
  factor_id              String      @db.Uuid
  created_at             DateTime    @db.Timestamptz(6)
  verified_at            DateTime?   @db.Timestamptz(6)
  ip_address             String      @db.Inet
  otp_code               String?
  web_authn_session_data Json?
  mfa_factors            mfa_factors @relation(fields: [factor_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "mfa_challenges_auth_factor_id_fkey")

  @@index([created_at(sort: Desc)], map: "mfa_challenge_created_at_idx")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model mfa_factors {
  id                           String           @id @db.Uuid
  user_id                      String           @db.Uuid
  friendly_name                String?
  factor_type                  factor_type
  status                       factor_status
  created_at                   DateTime         @db.Timestamptz(6)
  updated_at                   DateTime         @db.Timestamptz(6)
  secret                       String?
  phone                        String?
  last_challenged_at           DateTime?        @unique @db.Timestamptz(6)
  web_authn_credential         Json?
  web_authn_aaguid             String?          @db.Uuid
  last_webauthn_challenge_data Json?
  mfa_challenges               mfa_challenges[]
  users                        User             @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, phone], map: "unique_phone_factor_per_user")
  @@index([user_id, created_at], map: "factor_id_created_at_idx")
  @@index([user_id])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model oauth_authorizations {
  id                    String                     @id @db.Uuid
  authorization_id      String                     @unique
  client_id             String                     @db.Uuid
  user_id               String?                    @db.Uuid
  redirect_uri          String
  scope                 String
  state                 String?
  resource              String?
  code_challenge        String?
  code_challenge_method code_challenge_method?
  response_type         oauth_response_type        @default(code)
  status                oauth_authorization_status @default(pending)
  authorization_code    String?                    @unique
  created_at            DateTime                   @default(now()) @db.Timestamptz(6)
  expires_at            DateTime                   @default(dbgenerated("(now() + '00:03:00'::interval)")) @db.Timestamptz(6)
  approved_at           DateTime?                  @db.Timestamptz(6)
  nonce                 String?
  oauth_clients         oauth_clients              @relation(fields: [client_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users                 User?                      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model oauth_client_states {
  id            String   @id @db.Uuid
  provider_type String
  code_verifier String?
  created_at    DateTime @db.Timestamptz(6)

  @@index([created_at], map: "idx_oauth_client_states_created_at")
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model oauth_clients {
  id                   String                  @id @db.Uuid
  client_secret_hash   String?
  registration_type    oauth_registration_type
  redirect_uris        String
  grant_types          String
  client_name          String?
  client_uri           String?
  logo_uri             String?
  created_at           DateTime                @default(now()) @db.Timestamptz(6)
  updated_at           DateTime                @default(now()) @db.Timestamptz(6)
  deleted_at           DateTime?               @db.Timestamptz(6)
  client_type          oauth_client_type       @default(confidential)
  oauth_authorizations oauth_authorizations[]
  oauth_consents       oauth_consents[]
  sessions             sessions[]

  @@index([deleted_at])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model oauth_consents {
  id            String        @id @db.Uuid
  user_id       String        @db.Uuid
  client_id     String        @db.Uuid
  scopes        String
  granted_at    DateTime      @default(now()) @db.Timestamptz(6)
  revoked_at    DateTime?     @db.Timestamptz(6)
  oauth_clients oauth_clients @relation(fields: [client_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users         User          @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, client_id], map: "oauth_consents_user_client_unique")
  @@index([user_id, granted_at(sort: Desc)], map: "oauth_consents_user_order_idx")
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model one_time_tokens {
  id         String              @id @db.Uuid
  user_id    String              @db.Uuid
  token_type one_time_token_type
  token_hash String
  relates_to String
  created_at DateTime            @default(now()) @db.Timestamp(6)
  updated_at DateTime            @default(now()) @db.Timestamp(6)
  users      User                @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, token_type])
  @@index([relates_to], map: "one_time_tokens_relates_to_hash_idx", type: Hash)
  @@index([token_hash], map: "one_time_tokens_token_hash_hash_idx", type: Hash)
  @@schema("auth")
}

model password_reset_tokens {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String    @db.Uuid
  token_hash String    @unique
  expires_at DateTime  @db.Timestamptz(6)
  used_at    DateTime? @db.Timestamptz(6)
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  users      User      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([user_id], map: "idx_pw_reset_user")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model refresh_tokens {
  instance_id String?   @db.Uuid
  id          BigInt    @id @default(autoincrement())
  token       String?   @unique(map: "refresh_tokens_token_unique") @db.VarChar(255)
  user_id     String?   @db.VarChar(255)
  revoked     Boolean?
  created_at  DateTime? @db.Timestamptz(6)
  updated_at  DateTime? @db.Timestamptz(6)
  parent      String?   @db.VarChar(255)
  session_id  String?   @db.Uuid
  sessions    sessions? @relation(fields: [session_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([instance_id])
  @@index([instance_id, user_id])
  @@index([parent])
  @@index([session_id, revoked])
  @@index([updated_at(sort: Desc)])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model saml_providers {
  id                String        @id @db.Uuid
  sso_provider_id   String        @db.Uuid
  entity_id         String        @unique
  metadata_xml      String
  metadata_url      String?
  attribute_mapping Json?
  created_at        DateTime?     @db.Timestamptz(6)
  updated_at        DateTime?     @db.Timestamptz(6)
  name_id_format    String?
  sso_providers     sso_providers @relation(fields: [sso_provider_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([sso_provider_id])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model saml_relay_states {
  id              String        @id @db.Uuid
  sso_provider_id String        @db.Uuid
  request_id      String
  for_email       String?
  redirect_to     String?
  created_at      DateTime?     @db.Timestamptz(6)
  updated_at      DateTime?     @db.Timestamptz(6)
  flow_state_id   String?       @db.Uuid
  flow_state      flow_state?   @relation(fields: [flow_state_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  sso_providers   sso_providers @relation(fields: [sso_provider_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([created_at(sort: Desc)])
  @@index([for_email])
  @@index([sso_provider_id])
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model schema_migrations {
  version String @id @db.VarChar(255)

  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sessions {
  id                     String           @id @db.Uuid
  user_id                String           @db.Uuid
  created_at             DateTime?        @db.Timestamptz(6)
  updated_at             DateTime?        @db.Timestamptz(6)
  factor_id              String?          @db.Uuid
  aal                    aal_level?
  not_after              DateTime?        @db.Timestamptz(6)
  refreshed_at           DateTime?        @db.Timestamp(6)
  user_agent             String?
  ip                     String?          @db.Inet
  tag                    String?
  oauth_client_id        String?          @db.Uuid
  refresh_token_hmac_key String?
  refresh_token_counter  BigInt?
  scopes                 String?
  mfa_amr_claims         mfa_amr_claims[]
  refresh_tokens         refresh_tokens[]
  oauth_clients          oauth_clients?   @relation(fields: [oauth_client_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users                  User             @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([not_after(sort: Desc)])
  @@index([oauth_client_id])
  @@index([user_id])
  @@index([user_id, created_at], map: "user_id_created_at_idx")
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model sso_domains {
  id              String        @id @db.Uuid
  sso_provider_id String        @db.Uuid
  domain          String
  created_at      DateTime?     @db.Timestamptz(6)
  updated_at      DateTime?     @db.Timestamptz(6)
  sso_providers   sso_providers @relation(fields: [sso_provider_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([sso_provider_id])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model sso_providers {
  id                String              @id @db.Uuid
  resource_id       String?
  created_at        DateTime?           @db.Timestamptz(6)
  updated_at        DateTime?           @db.Timestamptz(6)
  disabled          Boolean?
  saml_providers    saml_providers[]
  saml_relay_states saml_relay_states[]
  sso_domains       sso_domains[]

  @@index([resource_id], map: "sso_providers_resource_id_pattern_idx")
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model blog_posts {
  id                 String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id            String    @db.Uuid
  title              String
  content            String
  excerpt            String?
  featured_image_url String?
  slug               String    @unique
  status             String    @default("draft")
  published_at       DateTime? @db.Timestamptz(6)
  created_at         DateTime  @default(now()) @db.Timestamptz(6)
  updated_at         DateTime  @default(now()) @db.Timestamptz(6)
  users              User      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  profiles           Profile   @relation(fields: [user_id], references: [userId], onDelete: NoAction, onUpdate: NoAction, map: "blog_posts_user_id_profiles_fkey")

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model chat_messages {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  chat_id    String    @db.Uuid
  sender_id  String    @db.Uuid
  message    String
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  read_at    DateTime? @db.Timestamptz(6)
  files      Json?
  chats      chats     @relation(fields: [chat_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  profiles   Profile   @relation(fields: [sender_id], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@schema("public")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model chats {
  id               String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  participant_1_id String          @db.Uuid
  participant_2_id String?         @db.Uuid
  source_type      String?
  source_id        String?         @db.Uuid
  created_at       DateTime        @default(now()) @db.Timestamptz(6)
  updated_at       DateTime        @default(now()) @db.Timestamptz(6)
  chat_messages    chat_messages[]

  @@unique([participant_1_id, participant_2_id, source_type, source_id])
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model cities {
  id                Int                 @id @default(autoincrement())
  key               String              @db.VarChar(255)
  municipality_id   Int
  lat               Float?
  lon               Float?
  municipalities    municipalities      @relation(fields: [municipality_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  city_translations city_translations[]

  @@unique([municipality_id, key], map: "ux_cities_muni_key")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model city_translations {
  id        Int    @id @default(autoincrement())
  city_id   Int
  lang_code String @db.VarChar(10)
  name      String @db.VarChar(255)
  cities    cities @relation(fields: [city_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([city_id, lang_code], map: "uq_city_tr_city_lang")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model equipment_listing_colors {
  listing_id         String             @db.Uuid
  color_id           Int
  equipment_colors   EquipmentColor     @relation(fields: [color_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  equipment_listings equipment_listings @relation(fields: [listing_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([listing_id, color_id])
  @@schema("public")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model equipment_listings {
  id                       String                     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id                  String                     @db.Uuid
  title                    String
  description              String
  price                    Decimal                    @db.Decimal(10, 2)
  currency                 String                     @default("EUR")
  condition                String
  size                     String?
  color                    String?
  country                  String
  images                   String[]                   @default([])
  status                   String                     @default("available")
  featured                 Boolean                    @default(false)
  views_count              Int                        @default(0)
  favorites_count          Int                        @default(0)
  created_at               DateTime                   @default(now()) @db.Timestamptz(6)
  updated_at               DateTime                   @default(now()) @db.Timestamptz(6)
  sold_at                  DateTime?                  @db.Timestamptz(6)
  visible                  Boolean?                   @default(false)
  city                     String?                    @default("")
  lat                      Float?
  lon                      Float?
  municipality             String?
  brand_id                 Int?
  material_id              Int?
  equipment_type_id        Int
  custom_equipment_type    String?
  equipment_listing_colors equipment_listing_colors[]
  equipment_brands         EquipmentBrand?            @relation(fields: [brand_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  equipment_types          EquipmentType              @relation(fields: [equipment_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  equipment_materials      EquipmentMaterial?         @relation(fields: [material_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users                    User                       @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profiles                 Profile                    @relation(fields: [user_id], references: [userId], onDelete: Cascade, onUpdate: NoAction, map: "equipment_listings_user_id_fkey1")

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model equipment_type_materials {
  equipment_type_id   Int
  material_id         Int
  equipment_types     EquipmentType     @relation(fields: [equipment_type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  equipment_materials EquipmentMaterial @relation(fields: [material_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([equipment_type_id, material_id])
  @@schema("public")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model forum_group_members {
  id           String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  group_id     String       @db.Uuid
  user_id      String       @db.Uuid
  role         String       @default("member")
  joined_at    DateTime     @default(now()) @db.Timestamptz(6)
  forum_groups forum_groups @relation(fields: [group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users        User         @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([group_id, user_id])
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model forum_groups {
  id                  String                @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                String
  description         String?
  is_private          Boolean               @default(false)
  owner_id            String                @db.Uuid
  avatar_url          String?
  member_count        Int                   @default(0)
  created_at          DateTime              @default(now()) @db.Timestamptz(6)
  updated_at          DateTime              @default(now()) @db.Timestamptz(6)
  forum_group_members forum_group_members[]
  users               User                  @relation(fields: [owner_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  forum_topics        ForumTopic[]
  group_announcements group_announcements[]
  group_invites       group_invites[]
  group_messages      group_messages[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model group_announcements {
  id           String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  group_id     String       @db.Uuid
  user_id      String       @db.Uuid
  title        String
  content      String
  created_at   DateTime     @default(now()) @db.Timestamptz(6)
  updated_at   DateTime     @default(now()) @db.Timestamptz(6)
  forum_groups forum_groups @relation(fields: [group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([group_id], map: "idx_group_announcements_group_id")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model group_invites {
  id           String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  group_id     String       @db.Uuid
  token        String       @unique
  created_by   String       @db.Uuid
  created_at   DateTime     @default(now()) @db.Timestamptz(6)
  expires_at   DateTime?    @db.Timestamptz(6)
  max_uses     Int?
  use_count    Int          @default(0)
  forum_groups forum_groups @relation(fields: [group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([token], map: "idx_group_invites_token")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model group_messages {
  id                   String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  group_id             String           @db.Uuid
  user_id              String           @db.Uuid
  message              String
  reply_to_id          String?          @db.Uuid
  files                Json?            @default("[]")
  created_at           DateTime         @default(now()) @db.Timestamptz(6)
  updated_at           DateTime         @default(now()) @db.Timestamptz(6)
  forum_groups         forum_groups     @relation(fields: [group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  group_messages       group_messages?  @relation("group_messagesTogroup_messages", fields: [reply_to_id], references: [id], onUpdate: NoAction)
  other_group_messages group_messages[] @relation("group_messagesTogroup_messages")

  @@index([created_at(sort: Desc)], map: "idx_group_messages_created_at")
  @@index([group_id], map: "idx_group_messages_group_id")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model horse_listing_colors {
  listing_id     String         @db.Uuid
  color_id       Int
  horse_colors   HorseColor     @relation(fields: [color_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  horse_listings horse_listings @relation(fields: [listing_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([listing_id, color_id])
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model horse_listing_disciplines {
  listing_id        String          @db.Uuid
  discipline_id     Int
  horse_disciplines HorseDiscipline @relation(fields: [discipline_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  horse_listings    horse_listings  @relation(fields: [listing_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([listing_id, discipline_id])
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model horse_listing_temperaments {
  id                String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  listing_id        String           @db.Uuid
  temperament_id    Int
  created_at        DateTime         @default(now()) @db.Timestamptz(6)
  horse_listings    horse_listings   @relation(fields: [listing_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  horse_temperament HorseTemperament @relation(fields: [temperament_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([listing_id], map: "idx_horse_listing_temperaments_listing_id")
  @@index([temperament_id], map: "idx_horse_listing_temperaments_temperament_id")
  @@schema("public")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model horse_listings {
  id                         String                       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id                    String                       @db.Uuid
  title                      String
  description                String
  price                      Decimal                      @db.Decimal
  currency                   String                       @default("EUR")
  country                    String
  images                     String[]                     @default([])
  status                     String                       @default("available")
  featured                   Boolean                      @default(false)
  views_count                Int                          @default(0)
  favorites_count            Int                          @default(0)
  created_at                 DateTime                     @default(now()) @db.Timestamptz(6)
  updated_at                 DateTime                     @default(now()) @db.Timestamptz(6)
  sold_at                    DateTime?                    @db.Timestamptz(6)
  age                        Int
  height                     Int
  registration_id            String?
  video_urls                 String[]                     @default([])
  breed_id                   Int?
  sex_id                     Int?
  animal_type                String                       @default("horse")
  pony_breed_id              Int?
  visible                    Boolean                      @default(false)
  municipality               String?
  lat                        Float?
  lon                        Float?
  city                       String?
  custom_breed               String?
  custom_pony_breed          String?
  horse_listing_colors       horse_listing_colors[]
  horse_listing_disciplines  horse_listing_disciplines[]
  horse_listing_temperaments horse_listing_temperaments[]
  profiles                   Profile                      @relation(fields: [user_id], references: [userId], onDelete: NoAction, onUpdate: NoAction, map: "fk_horse_profiles")
  horse_breeds               HorseBreed?                  @relation(fields: [breed_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  pony_breeds                PonyBreed?                   @relation(fields: [pony_breed_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  horse_sex                  HorseSex?                    @relation(fields: [sex_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users                      User                         @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([lat])
  @@index([lon])
  @@schema("public")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model listing_favorites {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id      String   @db.Uuid
  listing_id   String   @db.Uuid
  listing_type String
  created_at   DateTime @default(now()) @db.Timestamptz(6)

  @@unique([user_id, listing_id, listing_type])
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model municipalities {
  id                        Int                         @id @default(autoincrement())
  key                       String                      @db.VarChar(100)
  country_id                Int
  lat                       Float?
  lon                       Float?
  cities                    cities[]
  countries                 Country                     @relation(fields: [country_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  municipality_translations municipality_translations[]

  @@unique([key, country_id])
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model municipality_translations {
  id              Int            @id @default(autoincrement())
  municipality_id Int
  lang_code       String         @db.VarChar(5)
  name            String         @db.VarChar(100)
  municipalities  municipalities @relation(fields: [municipality_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([municipality_id, lang_code])
  @@unique([municipality_id, lang_code], map: "uq_muni_tr_muni_lang")
  @@schema("public")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model notifications {
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id        String    @db.Uuid
  type           String
  title          String
  content        String
  source_type    String?
  source_id      String?   @db.Uuid
  source_user_id String?   @db.Uuid
  metadata       Json?     @default("{}")
  read_at        DateTime? @db.Timestamptz(6)
  created_at     DateTime  @default(now()) @db.Timestamptz(6)
  updated_at     DateTime  @default(now()) @db.Timestamptz(6)

  @@index([user_id, created_at(sort: Desc)], map: "idx_notifications_user_id_created_at")
  @@index([user_id, read_at], map: "idx_notifications_user_id_read_at")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model service_favorites {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String   @db.Uuid
  service_id String   @db.Uuid
  created_at DateTime @default(now()) @db.Timestamptz(6)
  services   services @relation(fields: [service_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users      User     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, service_id])
  @@index([service_id], map: "idx_service_favorites_service_id")
  @@index([user_id], map: "idx_service_favorites_user_id")
  @@schema("public")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model services {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id           String              @db.Uuid
  full_name         String
  bio               String?
  hourly_rate       Decimal?            @db.Decimal(10, 2)
  specialty         String?
  regions_served    Json?
  phone             String?
  profile_photo_url String?
  visible           Boolean?            @default(true)
  created_at        DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?           @default(now()) @db.Timestamptz(6)
  views_count       Int                 @default(0)
  favorites_count   Int                 @default(0)
  pricing_type      String?             @default("per_hour")
  specialties       String[]
  custom_specialty  String?
  service_favorites service_favorites[]
  users             User                @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  profiles          Profile             @relation(fields: [user_id], references: [userId], onDelete: Cascade, onUpdate: NoAction, map: "services_user_id_profiles_fkey")

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model trainer_chats {
  id                                        String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  trainer_id                                String    @db.Uuid
  client_user_id                            String    @db.Uuid
  message                                   String
  sender_id                                 String    @db.Uuid
  created_at                                DateTime  @default(now()) @db.Timestamptz(6)
  read_at                                   DateTime? @db.Timestamptz(6)
  users_trainer_chats_client_user_idTousers User      @relation("trainer_chats_client_user_idTousers", fields: [client_user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users_trainer_chats_sender_idTousers      User      @relation("trainer_chats_sender_idTousers", fields: [sender_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  trainers                                  trainers  @relation(fields: [trainer_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model trainer_favorites {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String   @db.Uuid
  trainer_id String   @db.Uuid
  created_at DateTime @default(now()) @db.Timestamptz(6)

  @@unique([user_id, trainer_id])
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model trainer_language_translations {
  id                Int             @id @default(autoincrement())
  language_id       Int
  lang_code         String          @db.VarChar(5)
  name              String          @db.VarChar(255)
  trainer_languages TrainerLanguage @relation(fields: [language_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([language_id, lang_code])
  @@schema("public")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model trainers {
  id                    String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id               String          @db.Uuid
  name                  String
  photo_url             String?
  bio                   String
  specialties           String[]        @default([])
  years_experience      Int
  hourly_rate           Decimal?        @db.Decimal(10, 2)
  currency              String          @default("EUR")
  country               String?
  languages             String[]        @default([])
  certifications        String[]        @default([])
  website_url           String?
  phone                 String?
  verified              Boolean         @default(false)
  age                   Int?
  created_at            DateTime        @default(now()) @db.Timestamptz(6)
  updated_at            DateTime        @default(now()) @db.Timestamptz(6)
  visible               Boolean         @default(false)
  favorites_count       Int             @default(0)
  views_count           Int?            @default(0)
  city                  String?         @default("")
  municipality          String?
  lat                   Float?
  lon                   Float?
  certification_details Json?           @default("[]")
  admin1_mapbox_id      String?
  admin1_name           String?
  admin1_iso_code       String?
  files                 String[]        @default([])
  pricing_type          String?         @default("per_hour")
  trainer_chats         trainer_chats[]
  users                 User            @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  profiles              Profile         @relation(fields: [user_id], references: [userId], onDelete: Cascade, onUpdate: NoAction, map: "trainers_user_id_fkey1")

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model user_roles {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String   @db.Uuid
  role       app_role
  created_at DateTime @default(now()) @db.Timestamptz(6)
  users      User     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, role])
  @@schema("public")
}

enum aal_level {
  aal1
  aal2
  aal3

  @@schema("auth")
}

enum code_challenge_method {
  s256
  plain

  @@schema("auth")
}

enum factor_status {
  unverified
  verified

  @@schema("auth")
}

enum factor_type {
  totp
  webauthn
  phone

  @@schema("auth")
}

enum oauth_authorization_status {
  pending
  approved
  denied
  expired

  @@schema("auth")
}

enum oauth_client_type {
  public
  confidential

  @@schema("auth")
}

enum oauth_registration_type {
  dynamic
  manual

  @@schema("auth")
}

enum oauth_response_type {
  code

  @@schema("auth")
}

enum one_time_token_type {
  confirmation_token
  reauthentication_token
  recovery_token
  email_change_token_new
  email_change_token_current
  phone_change_token

  @@schema("auth")
}

enum app_role {
  super_admin
  admin
  moderator
  user
  super_master

  @@schema("public")
}

model Conversation {
  id        String   @id @default(uuid()) @db.Uuid
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  sourceType String?   @map("source_type")
  sourceId   String?   @map("source_id") @db.Uuid
  
  participants ConversationParticipant[]
  messages     Message[]

  @@map("conversations")
  @@schema("public")
}

model ConversationParticipant {
  conversationId String   @map("conversation_id") @db.Uuid
  userId         String   @map("user_id") @db.Uuid
  joinedAt       DateTime @default(now()) @map("joined_at") @db.Timestamptz(6)
  lastReadAt     DateTime? @map("last_read_at") @db.Timestamptz(6)

  conversation Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)
  user         Profile      @relation(fields: [userId], references: [userId], onDelete: Cascade)

  @@id([conversationId, userId])
  @@map("conversation_participants")
  @@schema("public")
}

model Message {
  id             String   @id @default(uuid()) @db.Uuid
  conversationId String   @map("conversation_id") @db.Uuid
  senderId       String   @map("sender_id") @db.Uuid
  content        String
  createdAt      DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  isRead         Boolean  @default(false) @map("is_read")
  attachments    String[] @default([])

  conversation Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)
  sender       Profile      @relation(fields: [senderId], references: [userId], onDelete: Cascade)

  @@map("messages")
  @@schema("public")
}

model Favorite {
  id           String   @id @default(uuid()) @db.Uuid
  userId       String   @map("user_id") @db.Uuid
  horseId      String?  @map("horse_listing_id") @db.Uuid
  equipmentId  String?  @map("equipment_listing_id") @db.Uuid
  trainerId    String?  @map("trainer_id") @db.Uuid
  serviceId    String?  @map("service_id") @db.Uuid
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("favorites")
  @@schema("public")
}

model Notification {
  id           String   @id @default(uuid()) @db.Uuid
  userId       String   @map("user_id") @db.Uuid
  type         String
  title        String
  content      String
  isRead       Boolean  @default(false) @map("is_read")
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  metadata     Json?    @default("{}")
  sourceType   String?  @map("source_type")
  sourceId     String?  @map("source_id") @db.Uuid
  sourceUserId String?  @map("source_user_id") @db.Uuid

  @@map("notifications")
  @@schema("public")
}
